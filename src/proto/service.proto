syntax = "proto3";

package oceandoc.proto;

import "src/proto/error.proto";

message Context {
  string private_ipv4 = 1;
  string private_ipv6 = 2;
  string public_ipv4 = 3;
  repeated string public_ipv6 = 4;
}

message Config {
  string name = 1;
}

message StatusReq {
  string request_id = 1;
  Context context = 2;
}

message StatusRes {
  string msg = 1;
}

message IpInfoReq {
  string request_id = 1;
}

message IpInfoRes {
  string msg = 1;
}

enum Op {
  Op_Unused = 0;
  Op_Put = 1;
  Op_Delete = 2;
  Op_Chmod = 3;
  Op_Chowner = 4;
}

message FileReq {
  Op op = 1;
  string path = 2;
  string sha256 = 3;
  int64 size = 4;
  string content = 5;
  int32 partition_num = 6;
  string repo_uuid = 7;
}

message FileRes {
  ErrCode err_code = 1;
  int32 partition_num = 2;
}

service OceanFile {
  rpc Status(StatusReq) returns (StatusRes);
  rpc IpInfo(IpInfoReq) returns (IpInfoRes);
  rpc PutFile(stream FileReq) returns (stream FileRes);
  rpc DelFile(FileReq) returns (FileRes);
  rpc Chmod(FileReq) returns (FileRes);
  rpc Chowner(FileReq) returns (FileRes);
}
